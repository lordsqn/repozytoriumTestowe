-----BEGIN CERTIFICATE-----
cGFja2FnZSBwbC5wa29icC50ZXN0a2l0LmNvcmUuZGF0YS5pbzsNCg0KaW1wb3J0
IG9yZy5hcGFjaGUuY29tbW9ucy5pby5GaWxlVXRpbHM7DQppbXBvcnQgb3JnLmFw
YWNoZS5jb21tb25zLmlvLklPVXRpbHM7DQppbXBvcnQgb3JnLmFwYWNoZS50aWth
LmNvbmZpZy5UaWthQ29uZmlnOw0KaW1wb3J0IG9yZy5hcGFjaGUudGlrYS5leGNl
cHRpb24uVGlrYUV4Y2VwdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLnRpa2EuaW8u
VGlrYUlucHV0U3RyZWFtOw0KaW1wb3J0IG9yZy5hcGFjaGUudGlrYS5tZXRhZGF0
YS5NZXRhZGF0YTsNCmltcG9ydCBvcmcuYXBhY2hlLnRpa2EubWV0YWRhdGEuVGlr
YUNvcmVQcm9wZXJ0aWVzOw0KaW1wb3J0IG9yZy5hcGFjaGUudGlrYS5taW1lLk1l
ZGlhVHlwZTsNCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOw0KaW1wb3J0IG9yZy5z
bGY0ai5Mb2dnZXJGYWN0b3J5Ow0KaW1wb3J0IHBsLnBrb2JwLnRlc3RraXQuY29y
ZS5kYXRhLkRhdGE7DQppbXBvcnQgcGwucGtvYnAudGVzdGtpdC5jb3JlLmxhbmcu
VHVwbGU7DQppbXBvcnQgcGwucGtvYnAudGVzdGtpdC5jb3JlLnN0YWdpbmcuRW52
aXJvbm1lbnRUZXN0ZXI7DQppbXBvcnQgcGwucGtvYnAudGVzdGtpdC5jb3JlLnN0
YWdpbmcuV29ya2VyU2V0dXA7DQoNCmltcG9ydCBqYXZhLmlvLio7DQppbXBvcnQg
amF2YS5uaW8uY2hhcnNldC5DaGFyc2V0Ow0KaW1wb3J0IGphdmEubmlvLmNoYXJz
ZXQuU3RhbmRhcmRDaGFyc2V0czsNCmltcG9ydCBqYXZhLm5pby5maWxlLio7DQpp
bXBvcnQgamF2YS5uaW8uZmlsZS5hdHRyaWJ1dGUuQmFzaWNGaWxlQXR0cmlidXRl
czsNCmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsNCmltcG9ydCBqYXZhLnV0aWwu
SGFzaFNldDsNCmltcG9ydCBqYXZhLnV0aWwuU2V0Ow0KDQppbXBvcnQgc3RhdGlj
IGphdmEubGFuZy5pbnZva2UuTWV0aG9kSGFuZGxlcy5sb29rdXA7DQoNCnB1Ymxp
YyBjbGFzcyBIREQgew0KICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBs
b2cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihsb29rdXAoKS5sb29rdXBDbGFz
cygpKTsNCg0KICAgIHB1YmxpYyBzdGF0aWMgU2V0PFN0cmluZz4gc2NhbkRpcmVj
dG9yeShTdHJpbmcgZm9sZGVyKSB7DQogICAgICAgIHJldHVybiBzY2FuRGlyZWN0
b3J5KFBhdGhzLmdldChmb2xkZXIpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgc3Rh
dGljIFNldDxTdHJpbmc+IHNjYW5EaXJlY3RvcnkoRmlsZSBmb2xkZXIpIHsNCiAg
ICAgICAgcmV0dXJuIHNjYW5EaXJlY3RvcnkoZm9sZGVyLnRvUGF0aCgpKTsNCiAg
ICB9DQoNCiAgICBwdWJsaWMgc3RhdGljIFNldDxTdHJpbmc+IHNjYW5EaXJlY3Rv
cnkoUGF0aCBmb2xkZXIpIHtyZXR1cm4gc2NhbkRpcmVjdG9yeShmb2xkZXIsIElu
dGVnZXIuTUFYX1ZBTFVFLCBmYWxzZSk7fQ0KDQogICAgcHVibGljIHN0YXRpYyBT
ZXQ8U3RyaW5nPiBzY2FuRGlyZWN0b3J5KFBhdGggZm9sZGVyLCBpbnQgZGVwdGgs
IGJvb2xlYW4gY291bnRGb2xkZXJzKSB7DQogICAgICAgIHJldHVybiBzY2FuRGly
ZWN0b3J5KGZvbGRlciwgZGVwdGgsIGNvdW50Rm9sZGVycywgbnVsbCk7DQogICAg
fQ0KDQogICAgcHVibGljIHN0YXRpYyBTZXQ8U3RyaW5nPiBzY2FuRGlyZWN0b3J5
KFBhdGggZm9sZGVyLCBpbnQgZGVwdGgsIGJvb2xlYW4gY291bnRGb2xkZXJzLCBB
Y2NlcHRGaWxlIGFjY2VwdEZpbGUpIHsNCiAgICAgICAgU2V0PFN0cmluZz4gcmVz
dWx0ID0gbmV3IEhhc2hTZXQ8PigpOw0KDQogICAgICAgIHRyeSB7DQogICAgICAg
ICAgICBGaWxlcy53YWxrRmlsZVRyZWUoZm9sZGVyLCBFbnVtU2V0Lm5vbmVPZihG
aWxlVmlzaXRPcHRpb24uY2xhc3MpLCBkZXB0aCwgbmV3IEdsb2JGaWxlVmlzaXRv
cihhY2NlcHRGaWxlLCBjb3VudEZvbGRlcnMsIHJlc3VsdCkpOw0KICAgICAgICB9
IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICBlLnByaW50U3Rh
Y2tUcmFjZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHJlc3VsdDsN
CiAgICB9DQoNCiAgICBARnVuY3Rpb25hbEludGVyZmFjZQ0KICAgIHB1YmxpYyBp
bnRlcmZhY2UgQWNjZXB0RmlsZSB7DQogICAgICAgIGJvb2xlYW4gaXNNYXRjaChT
dHJpbmcgcGF0aCk7DQogICAgfQ0KDQogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3Mg
R2xvYkZpbGVWaXNpdG9yIGltcGxlbWVudHMgRmlsZVZpc2l0b3I8UGF0aD4gew0K
ICAgICAgICBwcml2YXRlIGZpbmFsIFNldDxTdHJpbmc+IHJlc3VsdDsNCiAgICAg
ICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIGNvdW50Rm9sZGVyczsNCiAgICAgICAg
cHJpdmF0ZSBmaW5hbCBBY2NlcHRGaWxlIGFjY2VwdEZpbGU7DQoNCiAgICAgICAg
cHVibGljIEdsb2JGaWxlVmlzaXRvcihBY2NlcHRGaWxlIGFjY2VwdEZpbGUsIGJv
b2xlYW4gY291bnRGb2xkZXJzLCBTZXQ8U3RyaW5nPiByZXN1bHQpIHsNCiAgICAg
ICAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0Ow0KICAgICAgICAgICAgdGhpcy5j
b3VudEZvbGRlcnMgPSBjb3VudEZvbGRlcnM7DQogICAgICAgICAgICB0aGlzLmFj
Y2VwdEZpbGUgPSBhY2NlcHRGaWxlOw0KICAgICAgICB9DQoNCiAgICAgICAgQE92
ZXJyaWRlDQogICAgICAgIHB1YmxpYyBGaWxlVmlzaXRSZXN1bHQgdmlzaXRGaWxl
KFBhdGggZmlsZSwgQmFzaWNGaWxlQXR0cmlidXRlcyBhdHRycykgew0KICAgICAg
ICAgICAgaWYgKGFjY2VwdEZpbGUgPT0gbnVsbCB8fCBhY2NlcHRGaWxlLmlzTWF0
Y2goZmlsZS50b1N0cmluZygpKSkgcmVzdWx0LmFkZChmaWxlLnRvU3RyaW5nKCkp
Ow0KICAgICAgICAgICAgcmV0dXJuIEZpbGVWaXNpdFJlc3VsdC5DT05USU5VRTsN
CiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBAT3ZlcnJpZGUgRmlsZVZpc2l0
UmVzdWx0IHByZVZpc2l0RGlyZWN0b3J5KFBhdGggZGlyLCBCYXNpY0ZpbGVBdHRy
aWJ1dGVzIGF0dHJzKXsNCiAgICAgICAgICAgIGlmIChjb3VudEZvbGRlcnMpIHJl
c3VsdC5hZGQoZGlyLnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgcmV0dXJuIEZp
bGVWaXNpdFJlc3VsdC5DT05USU5VRTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1
YmxpYyBAT3ZlcnJpZGUgRmlsZVZpc2l0UmVzdWx0IHZpc2l0RmlsZUZhaWxlZChQ
YXRoIGZpbGUsIElPRXhjZXB0aW9uIGV4Yykge3JldHVybiBGaWxlVmlzaXRSZXN1
bHQuQ09OVElOVUU7fQ0KICAgICAgICBwdWJsaWMgQE92ZXJyaWRlIEZpbGVWaXNp
dFJlc3VsdCBwb3N0VmlzaXREaXJlY3RvcnkoUGF0aCBkaXIsIElPRXhjZXB0aW9u
IGV4Yyl7cmV0dXJuIEZpbGVWaXNpdFJlc3VsdC5DT05USU5VRTt9DQogICAgfQ0K
DQogICAgcHVibGljIHN0YXRpYyBSZWFkZXIgZ2V0UmVhZGVyKFN0cmluZyBwYXRo
KSB7DQogICAgICAgIHJldHVybiBnZXRSZWFkZXIocGF0aCwgU3RhbmRhcmRDaGFy
c2V0cy5VVEZfOCk7DQogICAgfQ0KDQogICAgcHVibGljIHN0YXRpYyBSZWFkZXIg
Z2V0UmVhZGVyKFN0cmluZyBwYXRoLCBDaGFyc2V0IGVuY29kaW5nKSB7DQogICAg
ICAgIHRyeSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IEJ1ZmZlcmVkUmVhZGVy
KG5ldyBJbnB1dFN0cmVhbVJlYWRlcihGaWxlcy5uZXdJbnB1dFN0cmVhbShQYXRo
cy5nZXQocGF0aCkpLCBlbmNvZGluZykpOw0KICAgICAgICB9IGNhdGNoIChFeGNl
cHRpb24gZSkgew0KICAgICAgICAgICAgbG9nLmVycm9yKCJFcnJvciByZWFkaW5n
IGZpbGU6ICIgKyBwYXRoICsgIiBjYXVzZTogIiArIGUuZ2V0Q2xhc3MoKS5nZXRT
aW1wbGVOYW1lKCkpOw0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAg
IH0NCiAgICB9DQoNCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyByZWFkRmlsZShT
dHJpbmcgcGF0aCkgew0KICAgICAgICByZXR1cm4gcmVhZEZpbGUocGF0aCwgU3Rh
bmRhcmRDaGFyc2V0cy5VVEZfOCk7DQogICAgfQ0KDQogICAgcHVibGljIHN0YXRp
YyBTdHJpbmcgcmVhZEZpbGUoU3RyaW5nIHBhdGgsIENoYXJzZXQgZW5jb2Rpbmcp
IHsNCiAgICAgICAgcmV0dXJuIHJlYWRGaWxlKFBhdGhzLmdldChwYXRoKSwgZW5j
b2RpbmcpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIHJlYWRG
aWxlKEZpbGUgZmlsZSkgew0KICAgICAgICByZXR1cm4gcmVhZEZpbGUoZmlsZSwg
U3RhbmRhcmRDaGFyc2V0cy5VVEZfOCk7DQogICAgfQ0KDQogICAgcHVibGljIHN0
YXRpYyBTdHJpbmcgcmVhZEZpbGUoRmlsZSBmaWxlLCBDaGFyc2V0IGVuY29kaW5n
KSB7DQogICAgICAgIHJldHVybiByZWFkRmlsZShmaWxlLnRvUGF0aCgpLCBlbmNv
ZGluZyk7DQogICAgfQ0KDQogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgcmVhZEZp
bGUoUGF0aCBwYXRoKSB7DQogICAgICAgIHJldHVybiByZWFkRmlsZShwYXRoLCBT
dGFuZGFyZENoYXJzZXRzLlVURl84KTsNCiAgICB9DQoNCiAgICBwdWJsaWMgc3Rh
dGljIFN0cmluZyByZWFkRmlsZShQYXRoIHBhdGgsIENoYXJzZXQgZW5jb2Rpbmcp
IHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5n
KEZpbGVzLnJlYWRBbGxCeXRlcyhwYXRoKSwgZW5jb2RpbmcpOw0KICAgICAgICB9
IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICBsb2cuZXJyb3Io
IkVycm9yIHJlYWRpbmcgZmlsZTogIiArIHBhdGgpOw0KICAgICAgICAgICAgcmV0
dXJuIG51bGw7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgc3RhdGlj
IFN0cmluZyByZWFkRmlsZShSZWFkZXIgcmVhZGVyKSB7DQogICAgICAgIHRyeSB7
DQogICAgICAgICAgICByZXR1cm4gSU9VdGlscy50b1N0cmluZyhyZWFkZXIpOw0K
ICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICBs
b2cuZXJyb3IoIkVycm9yIGR1cmluZyBmaWxlIHJlYWQiKTsNCiAgICAgICAgICAg
IHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHN0
YXRpYyBTdHJpbmcgcmVhZENsYXNzUGF0aEZpbGUoU3RyaW5nIGZpbGVJbkNsYXNz
UGF0aCkgew0KICAgICAgICBGaWxlIGNsYXNzUGF0aEZpbGUgPSBGaWxlVXRpbHMu
dG9GaWxlKERhdGEuY2xhc3MuZ2V0Q2xhc3NMb2FkZXIoKS5nZXRSZXNvdXJjZShm
aWxlSW5DbGFzc1BhdGgpKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlm
IChjbGFzc1BhdGhGaWxlICE9IG51bGwgJiYgY2xhc3NQYXRoRmlsZS5leGlzdHMo
KSAmJiBjbGFzc1BhdGhGaWxlLmNhblJlYWQoKSkgew0KICAgICAgICAgICAgICAg
IHJldHVybiBIREQucmVhZEZpbGUoY2xhc3NQYXRoRmlsZSk7DQogICAgICAgICAg
ICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlv
bigiQ2Fubm90IHJlYWQgIiArIGZpbGVJbkNsYXNzUGF0aCArICIgb3IgZmlsZSBu
b3QgZXhpc3QiKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoSU9F
eGNlcHRpb24gZSkgew0KICAgICAgICAgICAgbG9nLmVycm9yKGUuZ2V0TWVzc2Fn
ZSgpKTsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAg
fQ0KDQogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHNhdmVGaWxlKFBhdGggZmls
ZSwgU3RyaW5nIGNvbnRlbnQpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg
IEZpbGVzLndyaXRlKGZpbGUsIGNvbnRlbnQuZ2V0Qnl0ZXMoKSwgU3RhbmRhcmRP
cGVuT3B0aW9uLkNSRUFURSwgU3RhbmRhcmRPcGVuT3B0aW9uLlRSVU5DQVRFX0VY
SVNUSU5HKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGNh
dGNoIChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICBsb2cuZXJyb3IoIkFw
cGVuZCB0byBhIGZpbGUgIiArIGZpbGUgKyAiIGZhaWxlZDogIiArIGUuZ2V0TWVz
c2FnZSgpKTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0K
ICAgIH0NCg0KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBhcHBlbmRUb0ZpbGUo
UGF0aCBmaWxlLCBTdHJpbmcgY29udGVudCkgew0KICAgICAgICB0cnkgew0KICAg
ICAgICAgICAgRmlsZXMud3JpdGUoZmlsZSwgY29udGVudC5nZXRCeXRlcygpLCBT
dGFuZGFyZE9wZW5PcHRpb24uQ1JFQVRFLCBTdGFuZGFyZE9wZW5PcHRpb24uQVBQ
RU5EKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGNhdGNo
IChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICBsb2cuZXJyb3IoIkFwcGVu
ZCB0byBhIGZpbGUgIiArIGZpbGUgKyAiIGZhaWxlZDogIiArIGUuZ2V0TWVzc2Fn
ZSgpKTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAg
IH0NCg0KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBjb3B5RmlsZShQYXRoIHNv
dXJjZSwgUGF0aCBkZXN0aW5hdGlvbikgew0KICAgICAgICB0cnkgew0KICAgICAg
ICAgICAgRmlsZVV0aWxzLmNvcHlGaWxlKHNvdXJjZS50b0ZpbGUoKSwgZGVzdGlu
YXRpb24udG9GaWxlKCkpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAg
ICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIGxvZy5l
cnJvcigiRmlsZSBjb3B5ICIgKyBzb3VyY2UudG9GaWxlKCkgKyAiIGZhaWxlZDog
IiArIGUuZ2V0TWVzc2FnZSgpKTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsN
CiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBh
cHBlbmRMaW5lVG9GaWxlKFBhdGggZmlsZSwgU3RyaW5nIGNvbnRlbnQpIHsNCiAg
ICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghZmlsZS50b0ZpbGUoKS5leGlz
dHMoKSB8fCBmaWxlLnRvRmlsZSgpLmxlbmd0aCgpID09IDApIHsNCiAgICAgICAg
ICAgICAgICBhcHBlbmRUb0ZpbGUoZmlsZSwgY29udGVudCk7DQogICAgICAgICAg
ICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIEZpbGVzLndyaXRlKGZpbGUsICgi
XG4iICsgY29udGVudCkuZ2V0Qnl0ZXMoKSwgU3RhbmRhcmRPcGVuT3B0aW9uLkNS
RUFURSwgU3RhbmRhcmRPcGVuT3B0aW9uLkFQUEVORCk7DQogICAgICAgICAgICB9
DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBjYXRjaCAoSU9F
eGNlcHRpb24gZSkgew0KICAgICAgICAgICAgbG9nLmVycm9yKCJBcHBlbmQgdG8g
YSBmaWxlICIgKyBmaWxlICsgIiBmYWlsZWQ6ICIgKyBlLmdldE1lc3NhZ2UoKSk7
DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoN
CiAgICBwdWJsaWMgRmlsZSByZXNvbHZlKFN0cmluZyBsb2NhdG9yKSB0aHJvd3Mg
RXhjZXB0aW9uIHsNCiAgICAgICAgRmlsZSBmID0gbmV3IEZpbGUobG9jYXRvcik7
DQogICAgICAgIHJldHVybiBmLmV4aXN0cygpID8gZiA6IG51bGw7DQogICAgfQ0K
DQogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgbm9ybWFsaXplUGF0aChTdHJpbmcg
cGF0aCkgew0KICAgICAgICBTdHJpbmcgbnBhdGggPSBwYXRoLnRyaW0oKTsNCiAg
ICAgICAgbnBhdGggPSBucGF0aC5yZXBsYWNlKCIvIiwgV29ya2VyU2V0dXAuRlNF
UCk7DQogICAgICAgIG5wYXRoID0gbnBhdGgucmVwbGFjZSgiXFwiLCBXb3JrZXJT
ZXR1cC5GU0VQKTsNCiAgICAgICAgbnBhdGggPSBucGF0aC5zdGFydHNXaXRoKCIu
IikgPyBucGF0aC5zdWJzdHJpbmcoMSkgOiBucGF0aDsNCiAgICAgICAgaWYgKEVu
dmlyb25tZW50VGVzdGVyLmlzV2luZG93cygpICYmIG5wYXRoLnN0YXJ0c1dpdGgo
IlxcIikpDQogICAgICAgICAgICBucGF0aCA9IG5wYXRoLnN1YnN0cmluZygwLCA0
KS5tYXRjaGVzKCJcXFxcW0EtWmEtel06XFxcXCIpID8gbnBhdGguc3Vic3RyaW5n
KDEpIDogbnBhdGg7DQoNCiAgICAgICAgcmV0dXJuIG5wYXRoOw0KICAgIH0NCg0K
ICAgIHB1YmxpYyBlbnVtIFJlc291cmNlVHlwZSB7VEVYVCwgQklOQVJZLCBESVJF
Q1RPUlksIEFSQ0hJVkUsIE5PVEVYSVNUfQ0KICAgIHB1YmxpYyBzdGF0aWMgVHVw
bGU8UmVzb3VyY2VUeXBlLCBNZWRpYVR5cGU+IGRldGVjdFR5cGUoU3RyaW5nIHBh
dGgpIHsNCiAgICAgICAgaWYgKHBhdGggPT0gbnVsbCkgcmV0dXJuIFR1cGxlLm9m
KFJlc291cmNlVHlwZS5OT1RFWElTVCwgTWVkaWFUeXBlLkVNUFRZKTsNCiAgICAg
ICAgRmlsZSBsZiA9IG5ldyBGaWxlKHBhdGgpOw0KDQogICAgICAgIGlmIChsZi5l
eGlzdHMoKSkgew0KICAgICAgICAgICAgaWYgKGxmLmlzRGlyZWN0b3J5KCkpIHsN
CiAgICAgICAgICAgICAgICByZXR1cm4gVHVwbGUub2YoUmVzb3VyY2VUeXBlLkRJ
UkVDVE9SWSwgTWVkaWFUeXBlLnRleHQoImRpcmVjdG9yeSIpKTsNCiAgICAgICAg
ICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg
ICAgICAgICAgVGlrYUNvbmZpZyB0aWthID0gbmV3IFRpa2FDb25maWcoKTsNCiAg
ICAgICAgICAgICAgICAgICAgTWV0YWRhdGEgbWV0YWRhdGEgPSBuZXcgTWV0YWRh
dGEoKTsNCiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEuc2V0KFRpa2FDb3Jl
UHJvcGVydGllcy5SRVNPVVJDRV9OQU1FX0tFWSwgbGYudG9TdHJpbmcoKSk7DQog
ICAgICAgICAgICAgICAgICAgIE1lZGlhVHlwZSBtaW1lID0gdGlrYS5nZXREZXRl
Y3RvcigpLmRldGVjdCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaWth
SW5wdXRTdHJlYW0uZ2V0KGxmLnRvUGF0aCgpKSwgbWV0YWRhdGEpOw0KDQogICAg
ICAgICAgICAgICAgICAgIGlmIChtaW1lLmdldFR5cGUoKS5lcXVhbHMoInRleHQi
KSB8fCBtaW1lLmdldFN1YnR5cGUoKS5lcXVhbHMoInhtbCIpKSB7DQogICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gVHVwbGUub2YoUmVzb3VyY2VUeXBlLlRF
WFQsIG1pbWUpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1pbWUu
Z2V0U3VidHlwZSgpLmVxdWFscygiemlwIikgfHwgbWltZS5nZXRTdWJ0eXBlKCku
ZXF1YWxzKCJqYXZhLWFyY2hpdmUiKSkgew0KICAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIFR1cGxlLm9mKFJlc291cmNlVHlwZS5BUkNISVZFLCBtaW1lKTsN
CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBUdXBsZS5vZihSZXNvdXJjZVR5cGUuQklOQVJZLCBtaW1l
KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gY2F0
Y2ggKElPRXhjZXB0aW9uIHwgVGlrYUV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAg
ICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7DQogICAgICAgICAgICAgICAg
ICAgIHJldHVybiBUdXBsZS5vZihSZXNvdXJjZVR5cGUuQklOQVJZLCBNZWRpYVR5
cGUuRU1QVFkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAg
ICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBUdXBsZS5vZihSZXNv
dXJjZVR5cGUuTk9URVhJU1QsIE1lZGlhVHlwZS5FTVBUWSk7DQogICAgICAgIH0N
CiAgICB9DQoNCn0NCg==
-----END CERTIFICATE-----
